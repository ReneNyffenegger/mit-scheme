#!/bin/sh

# $Id: make-doc-files,v 1.15 2001/03/03 05:25:41 cph Exp $
#
# Copyright (c) 2000-2001 Massachusetts Institute of Technology
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or (at
# your option) any later version.
#
# This program is distributed in the hope that it will be useful, but
# WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.

. /scheme/v7/dist/release-prefix

INSTALL="install"
INSTALL_DATA="${INSTALL} -m 644"
DOCDIR="/scheme/v7/doc"
PREFIX=`get_release_prefix`
TAG=`get_release_tag`
TLDIR="`pwd`/${PREFIX}"

rm -rf ${TLDIR}
mkdir ${TLDIR}

make_tarfile ()
{
    TARFILE=${PREFIX}-doc-${1}.tar.gz
    rm -f ${TARFILE}
    tar cvzf ${TARFILE} ${PREFIX}
    chmod a-w ${TARFILE}
}

make_zipfile ()
{
    ZIPFILE=${PREFIX}-doc-${1}.zip
    rm -f ${ZIPFILE}
    zip -r ${ZIPFILE} ${PREFIX}
    chmod a-w ${ZIPFILE}
}

for TYPE in html info pdf ps; do
    mkdir ${TLDIR}/doc-${TYPE}
    (cd ${DOCDIR}; make install-${TYPE} ${TYPE}dir=${TLDIR}/doc-${TYPE})
    make_tarfile ${TYPE}
    make_zipfile ${TYPE}
    case "${TYPE}" in
    html | pdf)
	rm -rf doc-${TYPE}
	mv ${TLDIR}/doc-${TYPE} .
	;;
    esac
done

rm -rf ${TLDIR}
