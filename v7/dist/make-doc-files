#!/bin/sh

# $Id: make-doc-files,v 1.11 2000/11/28 17:32:03 cph Exp $
#
# Copyright (c) 2000 Massachusetts Institute of Technology
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or (at
# your option) any later version.
#
# This program is distributed in the hope that it will be useful, but
# WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.

COPY="cpx -h"

prefix=`/scheme/v7/dist/release-prefix`
tldir=${prefix}/doc
rm -rf ${prefix}
mkdir ${prefix}
mkdir ${tldir}

mans="ref-manual user-manual sos imail"
types="texinfo info ps pdf html"

for type in ${types}
do
  for man in ${mans}
  do
    case ${type} in
    info)
      ${COPY} /scheme/v7/doc/${man}/*.info* ${tldir}
      ;;
    html)
      ${COPY} /scheme/v7/doc/${man}/html/*.html ${tldir}
      ;;
    *)
      ${COPY} /scheme/v7/doc/${man}/*.${type} ${tldir}
      ;;
    esac
  done
done

${COPY} /scheme/v7/doc/ref-manual/COPYING ${tldir}
${COPY} /scheme/v7/linux/lib/edwin/info/dir ${tldir}
${COPY} /scheme/v7/dist/index.html ${tldir}

chmod 444 ${tldir}/*

for type in ${types}
do
  tarfile=${prefix}-doc-${type}.tar.gz
  rm -f ${tarfile}
  case ${type} in
  info)
    tar cvzf ${tarfile} ${tldir}/COPYING ${tldir}/dir ${tldir}/*.info*
    ;;
  *)
    tar cvzf ${tarfile} ${tldir}/COPYING ${tldir}/*.${type}
    ;;
  esac
  chmod 444 ${tarfile}
done

zipfile=${prefix}-doc-html.zip
rm -f ${zipfile}
zip -l ${zipfile} ${tldir}/COPYING ${tldir}/*.html
chmod 444 ${zipfile}

rm -rf doc-html
mkdir doc-html
mv ${tldir}/COPYING ${tldir}/*.html doc-html

rm -rf ${prefix}
