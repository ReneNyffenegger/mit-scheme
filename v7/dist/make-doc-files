#!/bin/sh

COPY="cpx -h"

prefix=`/scheme/v7/dist/release-prefix`
tldir=${prefix}/doc
rm -rf ${prefix}
mkdir ${prefix}
mkdir ${tldir}

mans="ref-manual user-manual sos imail"
types="texinfo info ps pdf html"

for type in ${types}
do
  for man in ${mans}
  do
    case ${type} in
    info)
      ${COPY} /scheme/documentation/${man}/*.info* ${tldir}
      ;;
    html)
      ${COPY} /scheme/documentation/${man}/html/*.html ${tldir}
      ;;
    *)
      ${COPY} /scheme/documentation/${man}/*.${type} ${tldir}
      ;;
    esac
  done
done

${COPY} /scheme/documentation/ref-manual/COPYING ${tldir}
${COPY} /scheme/v7/linux/lib/edwin/info/dir ${tldir}
${COPY} /scheme/v7/dist/index.html ${tldir}

chmod 444 ${tldir}/*

for type in ${types}
do
  tarfile=${prefix}-doc-${type}.tar.gz
  rm -f ${tarfile}
  case ${type} in
  info)
    tar cvzf ${tarfile} ${tldir}/COPYING ${tldir}/dir ${tldir}/*.info*
    ;;
  *)
    tar cvzf ${tarfile} ${tldir}/COPYING ${tldir}/*.${type}
    ;;
  esac
  chmod 444 ${tarfile}
done

zipfile=${prefix}-doc-html.zip
rm -f ${zipfile}
zip -l ${zipfile} ${tldir}/COPYING ${tldir}/*.html
chmod 444 ${zipfile}

rm -rf doc-html
mkdir doc-html
mv ${tldir}/COPYING ${tldir}/*.html doc-html

rm -rf ${prefix}
