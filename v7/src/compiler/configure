#!/bin/sh

# $Id: configure,v 1.10 2007/01/05 21:19:20 cph Exp $
#
# Copyright (C) 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994,
#     1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004,
#     2005, 2006, 2007 Massachusetts Institute of Technology
#
# This file is part of MIT/GNU Scheme.
#
# MIT/GNU Scheme is free software; you can redistribute it and/or
# modify it under the terms of the GNU General Public License as
# published by the Free Software Foundation; either version 2 of the
# License, or (at your option) any later version.
#
# MIT/GNU Scheme is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with MIT/GNU Scheme; if not, write to the Free Software
# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
# 02110-1301, USA.

enable_c_back_end="no"

while test $# -gt 0; do
    case "${1}" in
    (--enable-c-back-end)
	enable_c_back_end="yes"
	shift
	;;
    (--disable-c-back-end)
	enable_c_back_end="no"
	shift
	;;
    (*)
	shift
	;;
    esac
done

if test ! -e machine; then
    if test "${enable_c_back_end}" = "yes"; then
	MACHINE="C"
    else
	case `./config.guess` in
	(alpha-* | alphaev[56]-* | alphaev56-* | alphapca56-*)
	    MACHINE="alpha"
	    ;;
	(m68k-*)
	    MACHINE="bobcat"
	    ;;
	(i[3456]86-*)
	    MACHINE="i386"
	    ;;
	(mips-* | mipsel-*)
	    MACHINE="mips"
	    ;;
	(sparc-*)
	    MACHINE="sparc"
	    ;;
	(hppa-* | hppa1.[01]-* | hppa2.?-*)
	    MACHINE="spectrum"
	    ;;
	(vax-*)
	    MACHINE="vax"
	    ;;
	(*)
	    MACHINE="C"
	    ;;
	esac
    fi
    ln -s "machines/${MACHINE}" machine
fi
for FN in compiler.cbf compiler.pkg compiler.sf make.com; do
    test -h "${FN}" || ln -s "machine/${FN}" .;
done
